<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <meta name="viewport" content="width=320,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        #demo {
            width: 100%;
            height: 1200px;
            background: #ddd;
            background: -webkit-gradient(linear, 0% 0%, 0% 100%,from(#b8c4cb), to(#f6f6f8));
        }
    </style>
</head>
<body style="overflow:hidden;">
    <div id="demo" style="transform:translateY(0px);">
    </div>
    <script type="text/javascript">
        function Touch(dom) {
            this.dom = dom;
            this.pagex = 0;
            this.pagey = 0;
            this.movex = 0;
            this.movey = 0;
            this.x = 0;
            this.y = 0;
            this.cy = 0;
            this.cheight = document.compatMode === "CSS1Compat" ? document.documentElement.clientHeight : document.body.clientHeight;//可视区域高度
            this.sheight = document.compatMode === "CSS1Compat" ? document.documentElement.scrollHeight : document.body.scrollHeight;//document总高度
            if (typeof this.createTouch != "function") {
                Touch.prototype.createTouch = function () {
                    var than = this; //这里addEventListener里面的this变成dom
                    than.dom.addEventListener('touchstart', function (e) {
                        than.pagex = e.changedTouches[0].clientX;
                        than.pagey = e.changedTouches[0].clientY;
                    });
                    than.dom.addEventListener('touchmove', function (e) {
                    	console.log(than.cy);
                    	e.preventDefault();
                        than.movex = e.changedTouches[0].clientX;
                        than.movey = e.changedTouches[0].clientY;
                        than.x = than.movex - than.pagex;
                        than.y = than.movey - than.pagey;
                        if ((than.cy + than.y) >= 150) {
                            than.dom.setAttribute("style", "transform:translateY(150px)");
                        } else if ((-than.cheight + than.cy + than.y) < -(than.sheight + 150)) {
                            than.dom.setAttribute("style", "transform:translateY(" + (-than.sheight + than.cheight - 150) + "px)");
                        } else {
                            than.dom.setAttribute("style", "transform:translateY(" + (than.cy + than.y) + "px)");
                        }
                    });
                    than.dom.addEventListener('touchend', function (e) {
                        if ((than.cy + than.y) >= 0) {
                            than.dom.setAttribute("style", "transform:translateY(0px);transition:all 500ms ease 0s");
                            than.cy = 0;
                        } else if ((-than.cheight + than.cy + than.y) < -than.sheight) {
                            than.dom.setAttribute("style", "transform:translateY(" + (-than.sheight + than.cheight) + "px);transition:all 500ms ease 0s");
                            than.cy = (-than.sheight + than.cheight);
                        } else {
                            than.cy = than.cy + than.y;
                        }
                    });
                }
            }
        }

        var dom = document.getElementById("demo");
        var newTouch = new Touch(dom);
        newTouch.createTouch();
    </script>
</body>
</html>