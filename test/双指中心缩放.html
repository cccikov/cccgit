<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>双指中心缩放</title>
    <link rel="shortcut icon" href="img/ccc.ico" />
    <link rel="icon" href="img/ccc.ico" />
    <style>
        * {
            padding: 0;
            margin: 0;

        }

        .img-wrap {
            transform-origin: left top;
            box-shadow: 0px 0px 3px rgba(0, 0, 0, 0.3) inset;
            /* transition: transform 333ms cubic-bezier(.4,0,.22,1); */
        }

        .img-wrap img {
            display: block;
        }
    </style>
</head>

<body>
    <div id="wrap">
        <div class="img-wrap">
            <img src="./img/firefox_512.png">
        </div>
    </div>
    <script>
        class FingerCenter {
            constructor(imgWrapDom) {
                if (!imgWrapDom) {
                    return;
                }
                if (typeof imgWrapDom === "object" && imgWrapDom.nodeType === 1) {
                    this.el = imgWrapDom;
                } else if (typeof imgWrapDom === "string") {
                    var wrap = document.querySelectorAll(imgWrapDom)[0];
                    this.el = wrap;
                }
                this.init();
            }
            init() {
                var winW = window.innerWidth;
                var winH = window.innerHeight;
                var img = this.el.querySelectorAll("img")[0];
                this._imgOnload(img.src, () => {
                    var imgW = img.naturalHeight;
                    var imgH = img.naturalWidth;
                    var winRate = winW / winH;
                    var imgRate = imgW / imgH;
                    if (winRate > imgRate) {
                        this.height = winH;
                        this.width = winH * imgRate;
                        this.movex = (winW - this.width) / 2;
                        this.movey = 0;
                        img.style.transform = "translate3d(" + +"px, 0px, 0px) scale(1)";
                    } else {
                        this.width = winW;
                        this.height = winW / imgRate;
                        this.movex = 0;
                        this.movey = (winH - this.height) / 2;
                    }
                    this.scale = 1;
                    this.el.style.transform = "translate3d(" + this.movex + "px, " + this.movey +
                        "px, 0px) scale(" + this.scale + ")"; // 显示在屏幕中间
                    img.style.width = this.width + "px"; // 设置图片宽度
                    img.style.height = this.height + "px"; // 设置图片高度
                    console.log(this.el.getBoundingClientRect());
                    this._addListener();
                });
            }
            _imgOnload(src, cb) {
                var url = src;
                var newImg = new Image();
                newImg.onload = function () {
                    cb();
                }
                newImg.src = url;
            }
            _addListener() {
                var _this = this;
                this.touchstartListener = function (e) {
                    _this._touchstart(e);
                }
                _this.el.addEventListener("touchstart", _this.touchstartListener, false);
            }
            _removeListener() {
                var _this = this;
                _this.el.removeEventListener("touchstart", _this.touchstartListener, false);
            }
            _touchstart(e) {
                console.log(e.touches[0].clientX);
            }
        }

        var wrap = document.querySelectorAll(".img-wrap")[0];
        var instance = new FingerCenter(".img-wrap");
        console.log(instance);
    </script>
</body>

</html>